{% extends "hello/base.html" %}
{% load static %}

{% block title %}Book: {{ package.title }} â€¢ Book My Trip{% endblock %}

{% block css %}
<link rel="stylesheet" href="{% static 'hello/packages.css' %}">
<style>
  .book-wrap{max-width:1100px;margin:0 auto;padding:32px 16px}
  .book-head{text-align:center;margin:10px 0 28px}
  .book-head h1{font-size:42px;line-height:1.1;margin:0 0 6px}
  .book-head p{color:#6b7280;margin:0}
  .grid-2{display:grid;grid-template-columns:1.2fr .8fr;gap:22px}
  @media (max-width:900px){.grid-2{grid-template-columns:1fr}}
  .card{background:#fff;border-radius:20px;box-shadow:0 6px 26px rgba(0,0,0,.06);padding:18px 18px}
  .field{display:flex;flex-direction:column;gap:6px;margin-bottom:16px}
  .label{font-weight:700}
  .input, .select{width:100%;border-radius:12px;border:1px solid #e5e7eb;padding:12px 14px;font-size:16px}
  .hint{font-size:13px;color:#6b7280}
  .btn{display:inline-flex;align-items:center;justify-content:center;padding:10px 16px;border-radius:12px;font-weight:800;border:0;cursor:pointer}
  .btn-primary{background:#111;color:#fff}
  .btn-primary:hover{opacity:.9}
  .price-xl{font-weight:900;font-size:28px}
  .muted{color:#6b7280}
  .ul{margin:0;padding-left:20px}
  .ul li{margin:8px 0}
  .addon{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border:1px solid #e5e7eb;border-radius:12px;margin-bottom:10px}
  .addon label{display:flex;flex-direction:column}
  .hr{height:1px;background:#f1f3f5;margin:12px 0}
  .total-row{display:flex;align-items:center;justify-content:space-between;font-weight:900;font-size:20px;margin-top:8px}
  .extras{margin-top:30px}
  .extras h3{margin-bottom:10px}
  .row3{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px}
  .badge{display:inline-flex;align-items:center;gap:8px;border:1px solid #e5e7eb;border-radius:999px;padding:8px 12px;margin-right:8px;margin-top:6px}
</style>
{% endblock %}

{% block content %}
{% include "hello/partials/header.html" %}

<div class="book-wrap">
  <div class="book-head">
    <h1>Book: {{ package.title }}</h1>
    <p>Lock in your travelers and dates. Youâ€™ll see a confirmation page after this.</p>
  </div>

  <div class="grid-2">
    <!-- LEFT: Form -->
    <div class="card">
      <form method="post" novalidate>
        {% csrf_token %}

        <div class="field">
          <label class="label" for="id_number_of_people">Number of Travelers</label>
          {{ form.number_of_people }}
          <div class="hint">Secure booking for all travelers.</div>
        </div>

        <div class="field">
          <label class="label" for="id_travel_date">Travel Date</label>
          {{ form.travel_date }}
          <div class="hint">Flexible reschedule option available.</div>
        </div>

        <!-- Optional Add-ons -->
        <h3>Optional Add-ons</h3>
        <div class="addon">
          <label>Airport transfer (both ways)<span class="muted">Recommended for first-timers</span></label>
          <div>â‚¹2500 <input id="add_transfer" type="checkbox" style="margin-left:10px"></div>
        </div>
        <div class="addon">
          <label>Travel insurance<span class="muted">Medical, delay & baggage cover</span></label>
          <div>â‚¹1500 <input id="add_ins" type="checkbox" style="margin-left:10px"></div>
        </div>

        <div class="hr"></div>
        <button class="btn btn-primary" type="submit">Confirm Booking</button>

        <!-- NEW SECTION: Traveler Preferences -->
        <div class="extras">
          <h3>Traveler Preferences</h3>
          <div class="row3">
            <div>
              <label class="label">Departure City</label>
              <input class="input" placeholder="e.g. Delhi / Mumbai / Bengaluru">
            </div>
            <div>
              <label class="label">Hotel Category</label>
              <select class="select">
                <option>3â˜…</option>
                <option>4â˜…</option>
                <option>5â˜…</option>
                <option>Luxury Villa</option>
              </select>
            </div>
            <div>
              <label class="label">Trip Type</label>
              <select class="select">
                <option>Leisure</option>
                <option>Honeymoon</option>
                <option>Family Vacation</option>
                <option>Adventure</option>
              </select>
            </div>
          </div>

          <div class="field">
            <label class="label">Special Requests / Notes</label>
            <textarea class="input" rows="2" placeholder="Food preferences, preferred airlines, anniversaries, etc."></textarea>
          </div>
        </div>
      </form>
    </div>

    <!-- RIGHT: Summary -->
    <aside class="card">
      <h3 style="margin:0">{{ package.title }}</h3>
      <div class="muted">
        {% if package.destination %}{{ package.destination.name }}, {{ package.destination.country }}{% else %}Default Destination, Global{% endif %}
      </div>

      <div style="margin-top:14px">
        <span class="price-xl">â‚¹{{ package.price|floatformat:2 }}</span> <span class="muted">per traveler</span>
      </div>

      <div class="hr"></div>

      <div class="muted">Travelers</div>
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div><span id="travCount">1</span> Ã— â‚¹<span id="travPrice">{{ package.price|floatformat:2 }}</span></div>
        <div style="font-weight:800">â‚¹<span id="grandTotal">{{ package.price|floatformat:2 }}</span></div>
      </div>

      <div class="hr"></div>

      <h3>Whatâ€™s included</h3>
      <ul class="ul">
        <li>Explore the beauty of {{ package.title }} with our exclusive package.</li>
        <li><strong>Suggested duration:</strong> 4â€“7 days / 3â€“6 nights (customizable)</li>
        <li><strong>Stay:</strong> Handpicked 3â˜…/4â˜… hotels or villas</li>
        <li><strong>Meals:</strong> Daily breakfast and dinner included</li>
        <li><strong>Tours:</strong> City highlights & guided excursions</li>
        <li><strong>Tickets:</strong> Standard entry to listed attractions</li>
        <li><strong>Transfers:</strong> Local sightseeing transfers</li>
        <li><strong>Support:</strong> 24Ã—7 assistance via WhatsApp & call</li>
        <li><strong>Taxes & Fees:</strong> All applicable charges included</li>
        <li><strong>Visa / Insurance:</strong> Assistance available on request</li>
      </ul>

      <div class="badge"><span>ðŸ§¾</span> GST invoice on request</div>
    </aside>
  </div>
</div>

{% include "hello/partials/footer.html" %}

<script>
(function(){
  const ppl=document.getElementById('id_number_of_people'),
        t=document.getElementById('grandTotal'),
        price={{ package.price|floatformat:"0" }};
  ppl.addEventListener('input',()=>{t.textContent=(ppl.value*price).toLocaleString('en-IN')});
})();
</script>
{% endblock %}
